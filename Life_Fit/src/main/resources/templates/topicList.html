<!--
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>주제게시판</title>
    <style>
        .active {
            font-weight: bold;
            color: red;
        }
    </style>
</head>
<body>
<h1>주제게시판</h1>

&lt;!&ndash; 자유게시판으로 이동 &ndash;&gt;
<button onclick="location.href='/free'">자유게시판으로 이동</button>

<ul>
    <li>
        <a th:href="@{/topic}" th:text="'모든 지역'"
           th:classappend="${selectedLocalId == null} ? 'selected' : ''"></a>
    </li>
    <li th:each="local : ${localList}">
        <a th:href="@{/topic(localId=${local.localnum})}"
           th:text="${local.localname}">중구</a>
    </li>
</ul>
&lt;!&ndash; 지역 선택 및 글쓰기 &ndash;&gt;
<form id="writeForm" method="get" action="/topic">
    <label for="localSelect">지역 선택:</label>
    <select name="localId" id="localSelect" onchange="this.form.submit()">
        <option th:selected="${selectedLocalId == null}" value="">모든 지역</option>
        <option value="" disabled th:selected="${selectedLocalId == null}">지역을 선택하세요</option>
        <option th:each="local : ${localList}"
                th:value="${local.localnum}"
                th:text="${local.localname}"
                th:selected="${selectedLocalId != null and selectedLocalId == local.localnum}">
        </option>
    </select>
    &lt;!&ndash; 글쓰기 버튼은 따로 동작하도록 설정 &ndash;&gt;
    <button type="submit" formaction="/topic/write" formmethod="get">글쓰기</button>
</form>



&lt;!&ndash; 게시글 목록 &ndash;&gt;
<table border="1" cellpadding="5" cellspacing="0">
    <thead>
    <tr>
        <th>번호</th>
        <th>제목</th>
        <th>내용</th>
        <th>지역</th>
        <th>작성일</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="board : ${responseDTO.dtoList}">
        <td th:text="${board.bno}">1</td>
        <td>
            <a th:href="@{/board/{bno}(bno=${board.bno})}" th:text="${board.title}">제목</a>
        </td>
        <td th:text="${board.content}">내용</td>
      &lt;!&ndash;  <td>
            <span th:if="${board.localCate != null}" th:text="${board.localCate.localname}">지역명</span>
            <span th:unless="${board.localCate != null}">지역없음</span>
        </td>&ndash;&gt;
        <td>
        <span th:if="${board.localCateName != null}" th:text="${board.localCateName}">지역명</span>
        <span th:unless="${board.localCateName != null}">지역없음</span>

    </td>

        <td th:text="${#temporals.format(board.regdate, 'yyyy-MM-dd HH:mm')}">날짜</td>
    </tr>
    </tbody>
</table>

&lt;!&ndash; ✅ 페이징 영역 &ndash;&gt;
<div class="pagination">
    <a th:if="${responseDTO.prev}"
       th:href="@{/topic(localId=${selectedLocalId}, page=${responseDTO.start - 1}, size=${responseDTO.size})}">
        Prev
    </a>

    <span th:each="i : ${#numbers.sequence(responseDTO.start, responseDTO.end)}">
        <a th:href="@{/topic(localId=${selectedLocalId}, page=${i}, size=${responseDTO.size})}"
           th:classappend="${i == responseDTO.page} ? 'active'">
            [[${i}]]
        </a>
    </span>

    <a th:if="${responseDTO.next}"
       th:href="@{/topic(localId=${selectedLocalId}, page=${responseDTO.end + 1}, size=${responseDTO.size})}">

    </a>
</div>
&lt;!&ndash;<form method="get" action="/topic">
    <input type="text" name="keyword" placeholder="검색어 입력" th:value="${keyword}" />
    <button type="submit">검색</button>
</form>&ndash;&gt;
<form method="get" action="/topic">
    <input type="text" name="keyword" placeholder="검색어 입력" th:value="${keyword}" />

    <select name="searchType" th:value="${searchType}">
        <option value="all" th:selected="${searchType == 'all'}">제목 + 내용</option>
        <option value="title" th:selected="${searchType == 'title'}">제목만</option>
        <option value="content" th:selected="${searchType == 'content'}">내용만</option>
    </select>

    <button type="submit">검색</button>
</form>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const writeButton = document.querySelector("button[formaction='/topic/write']");
        const select = document.getElementById("localSelect");

        writeButton.addEventListener("click", function (e) {
            if (!select.value) {
                e.preventDefault();
                alert("지역을 선택해주세요!");
            }
        });
    });
</script>
</body>
</html>
-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>주제게시판</title>
    <link rel="stylesheet" href="/css/sidebar.css">
    <style>
        .active {
            font-weight: bold;
            color: red;
        }
    </style>
</head>
<body>
<div class="container">
    <!-- 사이드바 -->
    <div class="sidebar" th:replace="fragments/sidebar :: aside"></div>
    <div id="guidePanel" th:replace="fragments/guidePanel :: #guidePanel"></div>
    <!-- 본문 영역 -->
    <div class="content">
        <h1>주제게시판</h1>

        <!-- 자유게시판 이동 -->
        <button onclick="location.href='/free'">자유게시판으로 이동</button>

        <!-- 지역 선택 -->
        <form id="writeForm" method="get" action="/topic">
            <label for="localSelect">지역 선택:</label>
            <select name="localId" id="localSelect" onchange="this.form.submit()">
                <option value="" th:selected="${selectedLocalId == null}">모든 지역</option>
                <option th:each="local : ${localList}"
                        th:value="${local.localnum}"
                        th:text="${local.localname}"
                        th:selected="${selectedLocalId != null and selectedLocalId == local.localnum}">
                </option>
            </select>
            <button type="submit" formaction="/topic/write" formmethod="get">글쓰기</button>
        </form>

        <!-- 게시글 목록 -->
        <table border="1" cellpadding="5" cellspacing="0">
            <thead>
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>내용</th>
                <th>지역</th>
                <th>작성일</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="board : ${responseDTO.dtoList}">
                <td th:text="${board.bno}"></td>
                <td><a th:href="@{/board/{bno}(bno=${board.bno})}" th:text="${board.title}"></a></td>
                <td th:text="${board.content}"></td>
                <td>
                    <span th:if="${board.localCateName != null}" th:text="${board.localCateName}"></span>
                    <span th:unless="${board.localCateName != null}">지역없음</span>
                </td>
                <td th:text="${#temporals.format(board.regdate, 'yyyy-MM-dd HH:mm')}"></td>
            </tr>
            </tbody>
        </table>

        <!-- 페이징 -->
        <div class="pagination">
            <a th:if="${responseDTO.prev}"
               th:href="@{/topic(localId=${selectedLocalId}, page=${responseDTO.start - 1}, size=${responseDTO.size})}">Prev</a>
            <span th:each="i : ${#numbers.sequence(responseDTO.start, responseDTO.end)}">
                <a th:href="@{/topic(localId=${selectedLocalId}, page=${i}, size=${responseDTO.size})}"
                   th:classappend="${i == responseDTO.page} ? 'active'">[[${i}]]</a>
            </span>
            <a th:if="${responseDTO.next}"
               th:href="@{/topic(localId=${selectedLocalId}, page=${responseDTO.end + 1}, size=${responseDTO.size})}">Next</a>
        </div>

        <!-- 검색 -->
        <form method="get" action="/topic">
            <input type="text" name="keyword" placeholder="검색어 입력" th:value="${keyword}" />
            <select name="searchType" th:value="${searchType}">
                <option value="all" th:selected="${searchType == 'all'}">제목 + 내용</option>
                <option value="title" th:selected="${searchType == 'title'}">제목</option>
                <option value="content" th:selected="${searchType == 'content'}">내용</option>
            </select>
            <button type="submit">검색</button>
        </form>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const writeButton = document.querySelector("button[formaction='/topic/write']");
        const select = document.getElementById("localSelect");
        writeButton.addEventListener("click", function (e) {
            if (!select.value) {
                e.preventDefault();
                alert("지역을 선택해주세요!");
            }
        });
    });
</script>
<script src="/js/guide.js"></script>

</body>
</html>
