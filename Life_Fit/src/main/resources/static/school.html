<!-- 사용 API: https://www.career.go.kr/cnet/openapi/getOpenApi
 호출 방식: JavaScript의 fetch() 함수로 REST API 요청
 응답 형식: JSON
 출력정보: 학교명, 주소-->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>부산광역시 전체 학교 정보</title>
</head>
<body>
<h2>부산광역시 전체 학교 정보</h2>
<button onclick="fetchAllSchools()">불러오기</button>
<div id="output"></div>

<script>
    const apiKey = "4be57f8be2a5cfb3ec15fc2c91db959d";
    const gubuns = ["elem_list", "midd_list", "high_list", "univ_list", "seet_list", "alte_list"];

    async function fetchAllSchools() {
        const output = document.getElementById("output");
        output.innerHTML = "<p> 불러오는 중...</p>";
        let allData = [];

        for (let gubun of gubuns) {
            const url = `https://www.career.go.kr/cnet/openapi/getOpenApi`
                + `?apiKey=${apiKey}`
                + `&svcType=api`
                + `&svcCode=SCHOOL`
                + `&contentType=json`
                + `&region=100267`
                + `&gubun=${gubun}`
                + `&thisPage=1`
                + `&perPage=100`;

            try {
                const res = await fetch(url);
                const json = await res.json();
                const list = json?.dataSearch?.content || [];
                allData.push(...list);
            } catch (err) {
                console.error("오류:", err);
            }
        }

        if (allData.length === 0) {
            output.innerHTML = "<p style='color:red;'>불러올 학교 정보가 없습니다.</p>";
            return;
        }

        const ul = document.createElement("ul");
        allData.forEach(school => {
            const li = document.createElement("li");
            li.innerHTML = `
              <strong>학교명:</strong> ${school.schoolName}<br>
              <strong>주소:</strong> ${school.adres}<br><br>
            `;
            ul.appendChild(li);
        });

        output.innerHTML = "";
        output.appendChild(ul);
    }
</script>
</body>
</html>
